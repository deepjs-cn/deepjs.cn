import{_ as a,o as l,c as e,V as s}from"./chunks/framework.75ed6a74.js";const n=JSON.parse('{"title":"数据埋点采集","description":"","frontmatter":{},"headers":[{"level":3,"title":"埋点数据用来干什么","slug":"埋点数据用来干什么","link":"#埋点数据用来干什么","children":[]},{"level":3,"title":"为什么要埋点","slug":"为什么要埋点","link":"#为什么要埋点","children":[]},{"level":3,"title":"原理","slug":"原理","link":"#原理","children":[]},{"level":3,"title":"埋点方式","slug":"埋点方式","link":"#埋点方式","children":[]},{"level":3,"title":"实施方案","slug":"实施方案","link":"#实施方案","children":[]},{"level":3,"title":"通用埋点类型","slug":"通用埋点类型","link":"#通用埋点类型","children":[]}],"relativePath":"system-design/event-tracking/index.md","filePath":"system-design/event-tracking/index.md"}'),t={name:"system-design/event-tracking/index.md"},r=[s('<h1 id="数据埋点采集" tabindex="-1">数据埋点采集 <a class="header-anchor" href="#数据埋点采集" aria-label="Permalink to &quot;数据埋点采集&quot;">​</a></h1><blockquote><p>埋点（Event Tracking），是互联网数据采集工作中的一个俗称，正式应该叫事件跟踪，英文为 Event Tracking，它主要是针对特定用户行为或事件进行捕获、处理和发送的相关技术及其实施过程。</p></blockquote><h3 id="埋点数据用来干什么" tabindex="-1">埋点数据用来干什么 <a class="header-anchor" href="#埋点数据用来干什么" aria-label="Permalink to &quot;埋点数据用来干什么&quot;">​</a></h3><p>埋点数据主要是用来收集用户的行为数据的，网站收集用的的行为数据可以分析网站的运行效果、用户行为特点、业务的目标达成。同时，还可以通过这些数据，实现为用户提供个性化的推荐功能，以达到最大的业务转化率。</p><ul><li>在产品流程关键部位植相关统计代码，用来追踪每次用户的行为，统计关键流程的使用程度。</li><li>在产品中植入多段代码追踪用户连续行为，建立用户模型来具体化用户在使用产品中的操作行为。</li><li>与研发及数据分析师团队合作，通过数据埋点还原出用户画像及用户行为，建立数据分析后台，通过数据分析、优化产品。</li></ul><h3 id="为什么要埋点" tabindex="-1">为什么要埋点 <a class="header-anchor" href="#为什么要埋点" aria-label="Permalink to &quot;为什么要埋点&quot;">​</a></h3><p>网站自己产生的业务数据，如新闻网站发布的资讯文章、电商网站发布的商品信息等内容存放在网站自己的业务数据库里，网站如果有需要可以随时同步到数据仓库或者调取使用，但用户的行为，一般不会以业务数据的形式在数据库里存储，这有以下几个原因：</p><ul><li>用户的行为复杂：除了用户的基础的页面访问、链接点击跳转等行为外，还有诸如鼠标动作、滑动屏幕、实施重力感应等交互行为，这些行为呈现多样性，无法全部列举，在设计业务系统时一般不做考虑。</li><li>用户的行为数据量大：用户在产品上的行为互动频繁，尤其在移动互联网场景下多屏互动时，产品设计更倾向于引导用户完成相应的目标，用户也乐于与软件进行流畅的互动</li><li>用户的行为数据对业务无依赖：用户的行为数据与产品的主业务关联不大，用户的行为往往用于对用户进行后续的个性化的服务，但不会产生即时的影响。</li></ul><p>基于以上原因，我们需要专门收集用户的行为数据，就需要用到埋点操作。</p><h3 id="原理" tabindex="-1">原理 <a class="header-anchor" href="#原理" aria-label="Permalink to &quot;原理&quot;">​</a></h3><p>理点的原理非常简单，主要是通过前端代码，由场景触发，生成带有一定信息的格式化数据，后端将这些数据存储、清洗，最终用于分析。</p><p>以最为简单的浏览日志为例，用户在浏览网页时，触发 PV_log，在 PV_log 上可以携带当前的页面信息，如页面编号、页面的标题（Title）、页面的 URL、来源页面等信息，还可以携带用户的信息，如用户的 ID、设备、IP、地理信息等。</p><p>在 Web 端，一般采用 JS 来感知用户的行为，并发起数据上报，在 APP 端，会制作专门的 SDK 来感知用户的行为。</p><p>还有一类为后端埋点，与前端的流程类似，当用户在前端进行操作，引起后端业务系统逻辑触发，传递给日志系统，记录相应的数据日志。</p><h3 id="埋点方式" tabindex="-1">埋点方式 <a class="header-anchor" href="#埋点方式" aria-label="Permalink to &quot;埋点方式&quot;">​</a></h3><p>埋点一般有以下几种形式，代码埋点、可视化埋点（Visual Event Tracking）、全埋点，这些方式的本质是一样的，只不过是埋点的部署方式有所不同。</p><h4 id="代码埋点" tabindex="-1">代码埋点 <a class="header-anchor" href="#代码埋点" aria-label="Permalink to &quot;代码埋点&quot;">​</a></h4><p>因为需要监测网站上/app 上用户的行为，是需要在网页/app 中加上一些代码的，当用户触发相应行为时，进行数据上报，也就是代码埋点。这样的代码，在网站上叫监测代码，在 app 中叫 SDK（Software Development Kit）。第三方数据采集均支持代码埋点，GA, GrowingIO，神策等。</p><h4 id="可视化埋点" tabindex="-1">可视化埋点 <a class="header-anchor" href="#可视化埋点" aria-label="Permalink to &quot;可视化埋点&quot;">​</a></h4><p>利用可视化交互手段，数据产品/数据分析师可以通过可视化界面（管理后台连接设备）配置事件，如下是腾讯移动分析的可视化埋点界面。可视化埋点仍需要先配置相关事件，再采集。</p><h4 id="全埋点" tabindex="-1">全埋点 <a class="header-anchor" href="#全埋点" aria-label="Permalink to &quot;全埋点&quot;">​</a></h4><p>全埋点，也叫无埋点、无码埋点、自动埋点。全埋点是指预先收集用户的所有行为数据，然后再根据实际分析需求从中提取行为数据。</p><h4 id="区别" tabindex="-1">区别 <a class="header-anchor" href="#区别" aria-label="Permalink to &quot;区别&quot;">​</a></h4><p><img src="/assets/comparison-table-event-tracking.a94f10e2.jpg" alt="各埋点方式优缺点和适用场景对照表"></p><h3 id="实施方案" tabindex="-1">实施方案 <a class="header-anchor" href="#实施方案" aria-label="Permalink to &quot;实施方案&quot;">​</a></h3><p>埋点的方法有很多种，大部分是利用第三方统计工具（如云眼），也有在产品研发的时候直接在程序里嵌入代码统计搭建自己的后台以供查询。</p><ul><li>埋点的方式包括：手工埋点、可视化埋点、自动化埋点等。</li><li>按实现机理可以分为：手工编码嵌入、自动编码嵌入、运行时嵌入等。</li><li>使用第三方 sdk 埋点：如百度统计、友盟、TalkingData、Google Analytics、Sensors Analytics 等都提供了这一方案。</li></ul><p>前端一般采用如下原理实现数据埋点功能：</p><ul><li>用 JS 编写一个专门的事件函数，由用户事件触发</li><li>css 埋点，将日志服务 URL 伪装成图片背景图</li><li>xhr 上报</li><li>img/iframe/script 上报</li></ul><p>其中，以下是一个 CSS 上报的示例：</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">tracker</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">active</span><span style="color:#89DDFF;">::</span><span style="color:#C792EA;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#B2CCD6;">content</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">//www.baidu.com/tracker/report?action=hahadata</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>\n<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">tracker</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">点击我，会发埋点数据</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="通用埋点类型" tabindex="-1">通用埋点类型 <a class="header-anchor" href="#通用埋点类型" aria-label="Permalink to &quot;通用埋点类型&quot;">​</a></h3><p>一般有以下几种通用的埋点事件类型：</p><ul><li>访问日志</li><li>曝光日志</li><li>点击日志</li><li>滑动日志</li><li>播放日志</li><li>弹出</li><li>APP 启动/退出</li><li>push</li><li>等等</li></ul><p>参考</p><ul><li><a href="https://coffee.pmcaff.com/article/8gLp6Ww2B5" target="_blank" rel="noreferrer">https://coffee.pmcaff.com/article/8gLp6Ww2B5</a></li><li><a href="https://my.oschina.net/u/3721535/blog/1612630" target="_blank" rel="noreferrer">https://my.oschina.net/u/3721535/blog/1612630</a></li><li><a href="https://segmentfault.com/a/1190000037512181" target="_blank" rel="noreferrer">https://segmentfault.com/a/1190000037512181</a></li><li><a href="https://help.aliyun.com/document_detail/58225.html" target="_blank" rel="noreferrer">https://help.aliyun.com/document_detail/58225.html</a></li><li><a href="https://www.gairuo.com/p/event-tracking" target="_blank" rel="noreferrer">https://www.gairuo.com/p/event-tracking</a></li></ul>',36)];const i=a(t,[["render",function(a,s,n,t,i,o){return l(),e("div",null,r)}]]);export{n as __pageData,i as default};
